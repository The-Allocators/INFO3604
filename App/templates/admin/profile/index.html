{% extends "admin/base.html" %}

{% block title %}Profile - Help Desk System{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin/profile.css') }}">
{% endblock %}

{% block content %}
<div class="welcome-text">Welcome, {{ admin_profile.name }}</div>

<div class="profile-card">
    <h2>Your Profile</h2>
    <div class="profile-info">
        <img src="{{ url_for('static', filename='images/DefaultAvatar.jpg') }}" alt="{{ admin_profile.name }}" class="avatar avatar-lg">
        <div class="profile-details">
            <h3 class="profile-name">{{ admin_profile.name }}</h3>
            <p class="profile-id">{{ admin_profile.username }}</p>
            <p class="profile-email">{{ admin_profile.email }}</p>
        </div>
        <button class="btn btn-primary" id="editAdminProfileBtn">Edit</button>
    </div>
</div>

<div class="staff-card">
    <h2>Student Assistant Profiles</h2>
    <input type="text" id="staffSearch" class="staff-search" placeholder="Search by name or ID...">
    <div class="staff-grid" id="staffGrid">
        {% for student in students %}
        <div class="staff-item" data-username="{{ student.username }}">
            <img src="{{ url_for('static', filename='images/DefaultAvatar.jpg') }}" alt="{{ student.name }}" class="avatar avatar-sm">
            <div class="staff-info">
                <h4 class="staff-name">{{ student.name }}</h4>
                <p class="staff-id">{{ student.username }}</p>
            </div>
            <button class="btn btn-primary manage-btn" data-username="{{ student.username }}">Manage</button>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Admin Profile Edit Modal -->
<div id="adminEditModal" class="edit-modal">
    <div class="edit-modal-content">
        <button class="close-btn">&times;</button>
        <h2>Edit Your Profile</h2>
        <form id="adminEditForm">
            <div class="edit-form-group">
                <label for="adminName">Name</label>
                <input type="text" id="adminName" name="name" value="{{ admin_profile.name }}">
            </div>
            <div class="edit-form-group">
                <label for="adminEmail">Email</label>
                <input type="email" id="adminEmail" name="email" value="{{ admin_profile.email }}">
            </div>
            <div class="edit-form-actions">
                <span class="loading-spinner" id="adminSpinner"></span>
                <button type="button" class="btn btn-secondary" id="adminCancelBtn">Cancel</button>
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
        </form>
    </div>
</div>

<!-- Student Edit Modal -->
<div id="studentEditModal" class="edit-modal">
    <div class="edit-modal-content">
        <button class="close-btn">&times;</button>
        <h2>Edit Student Profile</h2>
        <form id="studentEditForm">
            <input type="hidden" id="studentUsername" name="username">
            <div class="edit-form-group">
                <label for="studentName">Name</label>
                <input type="text" id="studentName" name="name">
            </div>
            <div class="edit-form-group">
                <label for="studentDegree">Degree</label>
                <select id="studentDegree" name="degree">
                    <option value="BSc">BSc</option>
                    <option value="MSc">MSc</option>
                    <option value="PhD">PhD</option>
                </select>
            </div>
            <div class="edit-form-group">
                <label for="studentRate">Hourly Rate ($)</label>
                <input type="number" id="studentRate" name="rate" min="0" step="0.01">
            </div>
            <div class="edit-form-group">
                <label for="studentMinHours">Minimum Hours</label>
                <input type="number" id="studentMinHours" name="hours_minimum" min="0">
            </div>
            <div class="edit-form-actions">
                <span class="loading-spinner" id="studentSpinner"></span>
                <button type="button" class="btn btn-secondary" id="studentCancelBtn">Cancel</button>
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/admin/profile.js') }}"></script>
{% endblock %}